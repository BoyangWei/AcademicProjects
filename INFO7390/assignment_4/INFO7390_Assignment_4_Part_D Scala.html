<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>INFO7390_Assignment_4_Part_D Scala - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta name="robots" content="nofollow">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/358a53f93460d41f62b95cfd5ce6436b528c2b229982b8159a580fbbb91ef1fb/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/358a53f93460d41f62b95cfd5ce6436b528c2b229982b8159a580fbbb91ef1fb/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/358a53f93460d41f62b95cfd5ce6436b528c2b229982b8159a580fbbb91ef1fb/img/favicon.ico"/>
<script>window.settings = {"enableUsageDeliveryConfiguration":false,"enableNotebookNotifications":true,"enableSshKeyUI":false,"defaultInteractivePricePerDBU":0.4,"enableClusterMetricsUI":true,"allowWhitelistedIframeDomains":false,"enableOnDemandClusterType":true,"enableAutoCompleteAsYouType":[],"devTierName":"Community Edition","enableJobsPrefetching":true,"workspaceFeaturedLinks":[{"linkURI":"https://docs.databricks.com/index.html","displayName":"Documentation","icon":"question"},{"linkURI":"https://docs.databricks.com/release-notes/product/index.html","displayName":"Release Notes","icon":"code"},{"linkURI":"https://docs.databricks.com/spark/latest/training/index.html","displayName":"Training & Tutorials","icon":"graduation-cap"}],"enableReservoirTableUI":true,"enableClearStateFeature":true,"dbcForumURL":"http://forums.databricks.com/","enableProtoClusterInfoDeltaPublisher":true,"enableAttachExistingCluster":true,"resetJobListOnConnect":true,"serverlessDefaultSparkVersion":"latest-stable-scala2.11","maxCustomTags":45,"serverlessDefaultMaxWorkers":20,"enableInstanceProfilesUIInJobs":true,"nodeInfo":{"node_types":[{"support_ssh":false,"spark_heap_memory":4800,"instance_type_id":"r3.2xlarge","spark_core_oversubscription_factor":8.0,"node_type_id":"dev-tier-node","description":"Community Optimized","support_cluster_tags":false,"container_memory_mb":6000,"node_instance_type":{"instance_type_id":"r3.2xlarge","provider":"AWS","local_disk_size_gb":160,"compute_units":26.0,"number_of_ips":14,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":62464,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":0,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":6144,"is_hidden":false,"category":"Community Edition","num_cores":0.88,"support_port_forwarding":false,"support_ebs_volumes":false,"is_deprecated":false}],"default_node_type_id":"dev-tier-node"},"sqlAclsDisabledMap":{"spark.databricks.acl.enabled":"false","spark.databricks.acl.sqlOnly":"false"},"enableDatabaseSupportClusterChoice":true,"enableClusterAcls":true,"notebookRevisionVisibilityHorizon":999999,"serverlessClusterProductName":"Serverless Pool","showS3TableImportOption":true,"maxEbsVolumesPerInstance":10,"enableRStudioUI":false,"isAdmin":true,"deltaProcessingBatchSize":1000,"timerUpdateQueueLength":100,"sqlAclsEnabledMap":{"spark.databricks.acl.enabled":"true","spark.databricks.acl.sqlOnly":"true"},"enableLargeResultDownload":true,"maxElasticDiskCapacityGB":5000,"serverlessDefaultMinWorkers":2,"zoneInfos":[{"id":"us-west-2c","isDefault":true},{"id":"us-west-2b","isDefault":false},{"id":"us-west-2a","isDefault":false}],"enableCustomSpotPricingUIByTier":false,"serverlessClustersEnabled":false,"enableWorkspaceBrowserSorting":true,"enableSentryLogging":true,"enableFindAndReplace":true,"disallowUrlImportExceptFromDocs":false,"defaultStandardClusterModel":{"cluster_name":"","node_type_id":"dev-tier-node","spark_version":"3.5.x-scala2.11","num_workers":0,"aws_attributes":{"first_on_demand":0,"availability":"ON_DEMAND","zone_id":"us-west-2c","spot_bid_price_percent":100},"autotermination_minutes":120,"default_tags":{"Vendor":"Databricks","Creator":"liu.changsi@husky.neu.edu","ClusterName":null,"ClusterId":"<Generated after creation>"}},"enableEBSVolumesUIForJobs":true,"enablePublishNotebooks":true,"enableBitbucketCloud":true,"shouldShowCommandStatus":false,"createTableInNotebookS3Link":{"url":"https://docs.databricks.com/_static/notebooks/data-import/s3.html","displayName":"S3","workspaceFileName":"S3 Example"},"sanitizeHtmlResult":true,"enableJobAclsConfig":false,"enableFullTextSearch":false,"enableElasticSparkUI":false,"enableNewClustersCreate":true,"clusters":true,"allowRunOnPendingClusters":true,"useAutoscalingByDefault":false,"enableAzureToolbar":false,"fileStoreBase":"FileStore","enableEmailInAzure":false,"enableRLibraries":true,"enableTableAclsConfig":false,"enableSshKeyUIInJobs":true,"enableDetachAndAttachSubMenu":true,"configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableAdminPasswordReset":false,"checkBeforeAddingAadUser":false,"enableResetPassword":true,"maxClusterTagValueLength":255,"enableJobsSparkUpgrade":true,"createTableInNotebookDBFSLink":{"url":"https://docs.databricks.com/_static/notebooks/data-import/dbfs.html","displayName":"DBFS","workspaceFileName":"DBFS Example"},"perClusterAutoterminationEnabled":false,"enableNotebookCommandNumbers":true,"allowStyleInSanitizedHtml":true,"sparkVersions":[{"key":"1.6.3-db2-hadoop2-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-aba860a0ffce4f3471fb14aefdcb1d768ac66a53a5ad884c48745ef98aeb9d67","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"3.3.x-gpu-scala2.11","displayName":"3.3 (includes Apache Spark 2.2.0, GPU, Scala 2.11)","packageLabel":"spark-image-22756288786762d246bac1381e4f44610a4c2c3135c717c5ac3661822a723f1c","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.1-db5-scala2.11","displayName":"Spark 2.1.1-db5 (Scala 2.11)","packageLabel":"spark-image-08d9fc1551087e0876236f19640c4a83116b1649f15137427d21c9056656e80e","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.x-ubuntu15.10","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.3.x-scala2.10","displayName":"3.3 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-86a9b375074f5afad339e70230ec0ec265c4cefbd280844785fab3bcde5869f9","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.4.x-ubuntu15.10","displayName":"Spark 1.4.1 (Hadoop 1, deprecated)","packageLabel":"spark-image-f710650fb8aaade8e4e812368ea87c45cd8cd0b5e6894ca6c94f3354e8daa6dc","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.2.x-scala2.11","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-67ab3a06d1e83d5b60df7063245eb419a2e9fe329aeeb7e7d9713332c669bb17","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.1-db6-scala2.10","displayName":"Spark 2.1.1-db6 (Scala 2.10)","packageLabel":"spark-image-177f3f02a6a3432d30068332dc857b9161345bdd2ee8a2d2de05bb05cb4b0f4c","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.0-db2-scala2.11","displayName":"Spark 2.1.0-db2 (Scala 2.11)","packageLabel":"spark-image-267c4490a3ab8a39acdbbd9f1d36f6decdecebf013e30dd677faff50f1d9cf8b","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"4.0.x-scala2.11","displayName":"4.0 (includes Apache Spark 2.3.0, Scala 2.11)","packageLabel":"spark-image-fc9368293e1b3b6c37181d7af3123a4b9de5f7fa03cfd6dfaa038753256380c9","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"3.5.x-rc-scala2.11","displayName":"3.5.3 RC (Scala 2.11)","packageLabel":"spark-image-b89e23f14af00d3ce2cef6242aa703d4e1b3a3b1ea1fc83177349e50dc5bc05d","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"2.1.x-gpu-scala2.11","displayName":"Spark 2.1 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-d613235f93e0f29838beb2079a958c02a192ed67a502192bc67a8a5f2fb37f35","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.0.0-ubuntu15.10-scala2.10","displayName":"Spark 2.0.0 (Scala 2.10)","packageLabel":"spark-image-073c1b52ace74f251fae2680624a0d8d184a8b57096d1c21c5ce56c29be6a37a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"4.0.x-rc-scala2.11","displayName":"4.0.1 RC (Scala 2.11)","packageLabel":"spark-image-1dd6fd068f21d0e8cdec3b5ba7d430c08259174019537a00c71f214e60fcacfe","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"latest-stable-gpu-scala2.11","displayName":"Latest stable (GPU, Scala 2.11)","packageLabel":"spark-image-7a1e78fbfc4d1645e7478daa28377389b900aec38764df46bd836c1a9925499b","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.4.x-scala2.11","displayName":"3.4 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-f91cb0b3822c6641a9d346ef6c149118fb859b5e511ee01c31e958892ba23c7a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.2-db3-scala2.10","displayName":"Spark 2.0.2-db3 (Scala 2.10)","packageLabel":"spark-image-584091dedb690de20e8cf22d9e02fdcce1281edda99eedb441a418d50e28088f","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.2.x-scala2.10","displayName":"3.2 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-557788bea0eea16bbf7a8ba13ace07e64dd7fc86270bd5cea086097fe886431f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"latest-experimental-scala2.10","displayName":"Latest experimental (Scala 2.10)","packageLabel":"spark-image-ec81b6840af02ee2321dd8dfe2587437bbcddf024d4ae287f326a98fac406a6c","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.4.x-rc-gpu-scala2.11","displayName":"3.4.3 RC (GPU, Scala 2.11)","packageLabel":"spark-image-d129c4190d6b611b4b0af78a28fc0e59f4f4ba8970f18d9db12c168a06c059eb","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"4.0.x-gpu-scala2.11","displayName":"4.0 (includes Apache Spark 2.3.0, GPU, Scala 2.11)","packageLabel":"spark-image-b543c0700f83413b0055359ea9feaf285f2e2f3350fb7f301ea0e18b018b5cb5","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.0-db1-scala2.11","displayName":"Spark 2.1.0-db1 (Scala 2.11)","packageLabel":"spark-image-e8ad5b72cf0f899dcf2b4720c1f572ab0e87a311d6113b943b4e1d4a7edb77eb","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.1-db4-scala2.11","displayName":"Spark 2.1.1-db4 (Scala 2.11)","packageLabel":"spark-image-52bca0ca866e3f4243d3820a783abf3b9b3b553edf234abef14b892657ceaca9","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-rc-scala2.11","displayName":"Latest RC (4.1 snapshot, Scala 2.11)","packageLabel":"spark-image-9bee929b17aa336ada8a784b8033e288676a2f45af7daebb8a0c276644225641","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"latest-stable-scala2.11","displayName":"Latest stable (Scala 2.11)","packageLabel":"spark-image-c919ecd682175957255cbc87041d82633406312f7b74e018e165c4fe94943b5f","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"2.1.0-db2-scala2.10","displayName":"Spark 2.1.0-db2 (Scala 2.10)","packageLabel":"spark-image-a2ca4f6b58c95f78dca91b1340305ab3fe32673bd894da2fa8e1dc8a9f8d0478","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.3.x-rc-scala2.11","displayName":"3.3.3 RC (Scala 2.11)","packageLabel":"spark-image-d5f2cf68adadbdb8a00e5670640dcac9e49e918407593c3b1ef4c19f1a76ad0b","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.4.x-rc-scala2.11","displayName":"3.4.3 RC (Scala 2.11)","packageLabel":"spark-image-a6795e50c23adb41817f9d395124770f822a81585da5a8f04d528018fc0d73c4","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.x-ubuntu15.10-hadoop1","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db4-scala2.11","displayName":"Spark 2.0.2-db4 (Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.6.1-ubuntu15.10-hadoop1","displayName":"Spark 1.6.1 (Hadoop 1)","packageLabel":"spark-image-21d1cac181b7b8856dd1b4214a3a734f95b5289089349db9d9c926cb87d843db","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-gpu-scala2.11","displayName":"Spark 2.0 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-968b89f1d0ec32e1ee4dacd04838cae25ef44370a441224177a37980d539d83a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"3.3.x-rc-gpu-scala2.11","displayName":"3.3.3 RC (GPU, Scala 2.11)","packageLabel":"spark-image-c8581b8672b507d1e978f8b0455321e5a4d0adc9dbe8c8646d318e72d3fa3b30","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"1.6.2-ubuntu15.10-hadoop1","displayName":"Spark 1.6.2 (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"next-major-version-scala2.11","displayName":"Next major version (4.0 snapshot, Scala 2.11)","packageLabel":"spark-image-04bb47b0bae8165f760972376ce05083bc6102645f3f3851cd1cdf9cba13d6fe","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"1.6.3-db1-hadoop2-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-eaa8d9b990015a14e032fb2e2e15be0b8d5af9627cd01d855df728b67969d5d9","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"1.6.3-db2-hadoop1-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-14112ea0645bea94333a571a150819ce85573cf5541167d905b7e6588645cf3b","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"4.0.x-rc-gpu-scala2.11","displayName":"4.0.1 RC (GPU, Scala 2.11)","packageLabel":"spark-image-aa6bf69f81ae778363f8521763818794659d54858696e5fdc69d9e368bc5abed","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.5.x-scala2.10","displayName":"3.5 LTS (includes Apache Spark 2.2.1, Scala 2.10)","packageLabel":"spark-image-5e4f1f2feb631875a6036dffb069ec14b436939b5efe0ecb3ff8220c835298d6","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"1.6.2-ubuntu15.10-hadoop2","displayName":"Spark 1.6.2 (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"1.6.1-ubuntu15.10-hadoop2","displayName":"Spark 1.6.1 (Hadoop 2)","packageLabel":"spark-image-4cafdf8bc6cba8edad12f441e3b3f0a8ea27da35c896bc8290e16b41fd15496a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db2-scala2.10","displayName":"Spark 2.0.2-db2 (Scala 2.10)","packageLabel":"spark-image-36d48f22cca7a907538e07df71847dd22aaf84a852c2eeea2dcefe24c681602f","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-ubuntu15.10-scala2.11","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.11, deprecated)","packageLabel":"spark-image-8e1c50d626a52eac5a6c8129e09ae206ba9890f4523775f77af4ad6d99a64c44","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.3.x-rc-scala2.10","displayName":"3.3.3 RC (Scala 2.10)","packageLabel":"spark-image-a051c2ad0797e217b443bfc81b7207974ccc732233d23b81c07a1ecc53afb6ab","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-scala2.10","displayName":"Spark 2.0 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.1-db4-scala2.10","displayName":"Spark 2.1.1-db4 (Scala 2.10)","packageLabel":"spark-image-c7c0224de396cd1563addc1ae4bca6ba823780b6babe6c3729ddf73008f29ba4","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-rc-scala2.10","displayName":"Latest RC (Scala 2.10)","packageLabel":"spark-image-ec81b6840af02ee2321dd8dfe2587437bbcddf024d4ae287f326a98fac406a6c","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-stable-scala2.10","displayName":"Latest stable (Scala 2.10)","packageLabel":"spark-image-5e4f1f2feb631875a6036dffb069ec14b436939b5efe0ecb3ff8220c835298d6","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"2.0.2-db1-scala2.11","displayName":"Spark 2.0.2-db1 (Scala 2.11)","packageLabel":"spark-image-c2d623f03dd44097493c01aa54a941fc31978ebe6d759b36c75b716b2ff6ab9c","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.4.x-rc-scala2.10","displayName":"3.4.3 RC (Scala 2.10)","packageLabel":"spark-image-e1d485113c0970326db58efaa8302ac42ac6449ca0001520f8922d22cc65acc4","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.2-db4-scala2.10","displayName":"Spark 2.0.2-db4 (Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.1-db5-scala2.10","displayName":"Spark 2.1.1-db5 (Scala 2.10)","packageLabel":"spark-image-74133df2c13950431298d1cab3e865c191d83ac33648a8590495c52fc644c654","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.4.x-gpu-scala2.11","displayName":"3.4 (includes Apache Spark 2.2.0, GPU, Scala 2.11)","packageLabel":"spark-image-66d1366768039140a9f5409f3bab414cb7477ebd8d4bbf8b32cb885120f9f705","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2 (Hadoop 1, deprecated)","packageLabel":"spark-image-c9d2a8abf41f157a4acc6d52bc721090346f6fea2de356f3a66e388f54481698","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"latest-experimental-gpu-scala2.11","displayName":"Latest experimental (4.1 snapshot, GPU, Scala 2.11)","packageLabel":"spark-image-0715bf894e65ba51d72c6c185c96f71fe0a3d79c4b371ab24868c4ee32006754","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.2.x-scala2.10","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-d549f2d4a523994ecdf37e531b51d5ec7d8be51534bb0ca5322eaad28ba8f557","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.0.x-scala2.11","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-67ab3a06d1e83d5b60df7063245eb419a2e9fe329aeeb7e7d9713332c669bb17","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.x-scala2.11","displayName":"Spark 2.0 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.x-scala2.10","displayName":"Spark 2.1 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-177f3f02a6a3432d30068332dc857b9161345bdd2ee8a2d2de05bb05cb4b0f4c","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.1.x-scala2.11","displayName":"3.1 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-241fa8b78ee6343242b1756b18076270894385ff40a81172a6fb5eadf66155d3","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.1.0-db3-scala2.10","displayName":"Spark 2.1.0-db3 (Scala 2.10)","packageLabel":"spark-image-25a17d070af155f10c4232dcc6248e36a2eb48c24f8d4fc00f34041b86bd1626","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.2-db2-scala2.11","displayName":"Spark 2.0.2-db2 (Scala 2.11)","packageLabel":"spark-image-4fa852ba378e97815083b96c9cada7b962a513ec23554a5fc849f7f1dd8c065a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.5.x-rc-gpu-scala2.11","displayName":"3.5.3 RC (GPU, Scala 2.11)","packageLabel":"spark-image-6c4af176dddb5ffeeaa4f14100b0bd9d7609689222ddd85c2a1d4b880def1963","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.1.x-scala2.10","displayName":"3.1 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-7efac6b9a8f2da59cb4f6d0caac46cfcb3f1ebf64c8073498c42d0360f846714","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.3.x-scala2.11","displayName":"3.3 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-46cc39a9afa43fbd7bfa9f4f5ed8d23f658cd0b0d74208627243222ae0d22f8d","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"next-major-version-gpu-scala2.11","displayName":"Next major version (4.0 snapshot, GPU, Scala 2.11)","packageLabel":"spark-image-41e21a0db3b77bc857f10358917ccbf5fbd85290e8429c2176a5fc7a29ce4f18","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.5.x-gpu-scala2.11","displayName":"3.5 LTS (includes Apache Spark 2.2.1, GPU, Scala 2.11)","packageLabel":"spark-image-7a1e78fbfc4d1645e7478daa28377389b900aec38764df46bd836c1a9925499b","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.3.x-ubuntu15.10","displayName":"Spark 1.3.0 (Hadoop 1, deprecated)","packageLabel":"spark-image-40d2842670bc3dc178b14042501847d76171437ccf70613fa397a7a24c48b912","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.1-db1-scala2.11","displayName":"Spark 2.0.1-db1 (Scala 2.11)","packageLabel":"spark-image-10ab19f634bbfdb860446c326a9f76dc25bfa87de6403b980566279142a289ea","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db3-scala2.11","displayName":"Spark 2.0.2-db3 (Scala 2.11)","packageLabel":"spark-image-7fd7aaa89d55692e429115ae7eac3b1a1dc4de705d50510995f34306b39c2397","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.1.1-db6-scala2.11","displayName":"Spark 2.1.1-db6 (Scala 2.11)","packageLabel":"spark-image-fdad9ef557700d7a8b6bde86feccbcc3c71d1acdc838b0fd299bd19956b1076e","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.3-db1-hadoop1-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-d50af1032799546b8ccbeeb76889a20c819ebc2a0e68ea20920cb30d3895d3ae","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db1-scala2.10","displayName":"Spark 2.0.2-db1 (Scala 2.10)","packageLabel":"spark-image-654bdd6e9bad70079491987d853b4b7abf3b736fff099701501acaabe0e75c41","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-ubuntu15.10","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.10, deprecated)","packageLabel":"spark-image-a659f3909d51b38d297b20532fc807ecf708cfb7440ce9b090c406ab0c1e4b7e","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.5.x-scala2.11","displayName":"3.5 LTS (includes Apache Spark 2.2.1, Scala 2.11)","packageLabel":"spark-image-c919ecd682175957255cbc87041d82633406312f7b74e018e165c4fe94943b5f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"latest-experimental-scala2.11","displayName":"Latest experimental (4.1 snapshot, Scala 2.11)","packageLabel":"spark-image-9bee929b17aa336ada8a784b8033e288676a2f45af7daebb8a0c276644225641","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"3.2.x-scala2.11","displayName":"3.2 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-5537926238bc55cb6cd76ee0f0789511349abead3781c4780721a845f34b5d4e","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.0.1-db1-scala2.10","displayName":"Spark 2.0.1-db1 (Scala 2.10)","packageLabel":"spark-image-5a13c2db3091986a4e7363006cc185c5b1108c7761ef5d0218506cf2e6643840","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.x-scala2.11","displayName":"Spark 2.1 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-fdad9ef557700d7a8b6bde86feccbcc3c71d1acdc838b0fd299bd19956b1076e","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.0-db1-scala2.10","displayName":"Spark 2.1.0-db1 (Scala 2.10)","packageLabel":"spark-image-f0ab82a5deb7908e0d159e9af066ba05fb56e1edb35bdad41b7ad2fd62a9b546","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.0.x-scala2.10","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-d549f2d4a523994ecdf37e531b51d5ec7d8be51534bb0ca5322eaad28ba8f557","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.0-ubuntu15.10","displayName":"Spark 1.6.0 (Hadoop 1)","packageLabel":"spark-image-10ef758029b8c7e19cd7f4fb52fff9180d75db92ca071bd94c47f3c1171a7cb5","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"1.6.x-ubuntu15.10-hadoop2","displayName":"Spark 1.6.x (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.0-ubuntu15.10-scala2.11","displayName":"Spark 2.0.0 (Scala 2.11)","packageLabel":"spark-image-b4ec141e751f201399f8358a82efee202560f7ed05e1a04a2ae8778f6324b909","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.0-db3-scala2.11","displayName":"Spark 2.1.0-db3 (Scala 2.11)","packageLabel":"spark-image-ccbc6b73f158e2001fc1fb8c827bfdde425d8bd6d65cb7b3269784c28bb72c16","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-rc-gpu-scala2.11","displayName":"Latest RC (4.1 snapshot, GPU, Scala 2.11)","packageLabel":"spark-image-0715bf894e65ba51d72c6c185c96f71fe0a3d79c4b371ab24868c4ee32006754","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.5.x-rc-scala2.10","displayName":"3.5.3 RC (Scala 2.10)","packageLabel":"spark-image-59c460aebf9f888f79daf0e7257d39b41425f0971ae290ee37fbc1ebd75c5506","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"3.4.x-scala2.10","displayName":"3.4 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-867d7300605c0c54b2b1394d1bba7b88b28ed5841b3575253cded34db6ce6454","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]}],"enablePresentationMode":false,"enableClearStateAndRunAll":true,"enableTableAclsByTier":false,"enableRestrictedClusterCreation":true,"enableFeedback":true,"enableClusterAutoScaling":false,"enableUserVisibleDefaultTags":true,"defaultNumWorkers":0,"serverContinuationTimeoutMillis":10000,"jobsUnreachableThresholdMillis":60000,"driverStderrFilePrefix":"stderr","enableNotebookRefresh":false,"createTableInNotebookImportedFileLink":{"url":"https://docs.databricks.com/_static/notebooks/data-import/imported-file.html","displayName":"Imported File","workspaceFileName":"Imported File Example"},"accountsOwnerUrl":"https://accounts.cloud.databricks.com/registration.html#login","tableAclsDisabledMap":{"spark.databricks.acl.dfAclsEnabled":"false"},"driverStdoutFilePrefix":"stdout","showDbuPricing":true,"databricksDocsBaseHostname":"docs.databricks.com","defaultNodeTypeToPricingUnitsMap":{"r3.2xlarge":2,"i3.4xlarge":4,"class-node":1,"m4.2xlarge":1.5,"r4.xlarge":1,"m4.4xlarge":3,"Standard_DS5_v2":3,"Standard_D2s_v3":0.5,"Standard_DS4_v2_Promo":1.5,"Standard_DS14":4,"Standard_DS11_v2_Promo":0.5,"r4.16xlarge":16,"Standard_DS11":0.5,"Standard_D2_v3":0.5,"Standard_DS14_v2_Promo":4,"Standard_D64s_v3":12,"p2.8xlarge":16,"m4.10xlarge":8,"Standard_D8s_v3":1.5,"Standard_E32s_v3":8,"Standard_DS3":0.75,"Standard_DS2_v2":0.5,"r3.8xlarge":8,"r4.4xlarge":4,"dev-tier-node":1,"Standard_L8s":2,"Standard_DS13_v2_Promo":2,"Standard_E4s_v3":1,"Standard_D3_v2":0.75,"Standard_DS15_v2":5,"Standard_D16s_v3":3,"Standard_D5_v2":3,"Standard_E8s_v3":2,"Standard_DS2_v2_Promo":0.5,"c3.8xlarge":4,"Standard_D4_v3":0.75,"Standard_E2s_v3":0.5,"Standard_D32_v3":6,"Standard_DS3_v2":0.75,"r3.4xlarge":4,"Standard_DS4":1.5,"i2.4xlarge":6,"Standard_DS3_v2_Promo":0.75,"m4.xlarge":0.75,"r4.8xlarge":8,"Standard_H16":4,"Standard_DS14_v2":4,"r4.large":0.5,"Standard_DS12":1,"development-node":1,"i2.2xlarge":3,"g2.8xlarge":6,"i3.large":0.75,"memory-optimized":1,"m4.large":0.4,"Standard_D16_v3":3,"Standard_F4s":0.5,"p2.16xlarge":24,"i3.8xlarge":8,"Standard_D32s_v3":6,"i3.16xlarge":16,"Standard_DS12_v2":1,"Standard_L32s":8,"Standard_D4s_v3":0.75,"Standard_DS13":2,"Standard_DS11_v2":0.5,"Standard_DS12_v2_Promo":1,"Standard_DS13_v2":2,"c3.2xlarge":1,"Standard_L4s":1,"Standard_F16s":2,"c4.2xlarge":1,"Standard_L16s":4,"i2.xlarge":1.5,"Standard_DS2":0.5,"compute-optimized":1,"c4.4xlarge":2,"Standard_DS5_v2_Promo":3,"Standard_D64_v3":12,"Standard_D2_v2":0.5,"Standard_D8_v3":1.5,"i3.2xlarge":2,"Standard_E16s_v3":4,"Standard_F8s":1,"c3.4xlarge":2,"g2.2xlarge":1.5,"p2.xlarge":2,"m4.16xlarge":12,"Standard_DS4_v2":1.5,"c4.8xlarge":4,"i3.xlarge":1,"r3.xlarge":1,"r4.2xlarge":2,"i2.8xlarge":12},"tableFilesBaseFolder":"/tables","enableSparkDocsSearch":true,"sparkHistoryServerEnabled":true,"enableClusterAppsUIOnServerless":false,"enableEBSVolumesUI":false,"homePageWelcomeMessage":"Welcome to ","metastoreServiceRowLimit":1000000,"enableIPythonImportExport":true,"enableClusterTagsUIForJobs":true,"enableClusterTagsUI":false,"enableNotebookHistoryDiffing":true,"branch":"2.67.1037","accountsLimit":3,"enableSparkEnvironmentVariables":true,"enableX509Authentication":false,"useAADLogin":false,"enableStructuredStreamingNbOptimizations":true,"enableNotebookGitBranching":true,"local":false,"enableNotebookLazyRenderWrapper":false,"enableClusterAutoScalingForJobs":true,"enableStrongPassword":false,"showReleaseNote":true,"displayDefaultContainerMemoryGB":6,"broadenedEditPermission":false,"disableS3TableImport":false,"enableArrayParamsEdit":true,"deploymentMode":"production","useSpotForWorkers":true,"removePasswordInAccountSettings":false,"preferStartTerminatedCluster":false,"enableUserInviteWorkflow":true,"createTableConnectorOptionLinks":[{"url":"https://docs.databricks.com/_static/notebooks/redshift.html","displayName":"Amazon Redshift","workspaceFileName":"Amazon Redshift Example"},{"url":"https://docs.databricks.com/_static/notebooks/structured-streaming-kinesis.html","displayName":"Amazon Kinesis","workspaceFileName":"Amazon Kinesis Example"},{"url":"https://docs.databricks.com/_static/notebooks/data-import/jdbc.html","displayName":"JDBC","workspaceFileName":"JDBC Example"},{"url":"https://docs.databricks.com/_static/notebooks/cassandra.html","displayName":"Cassandra","workspaceFileName":"Cassandra Example"},{"url":"https://docs.databricks.com/_static/notebooks/structured-streaming-etl-kafka.html","displayName":"Kafka","workspaceFileName":"Kafka Example"},{"url":"https://docs.databricks.com/_static/notebooks/redis.html","displayName":"Redis","workspaceFileName":"Redis Example"},{"url":"https://docs.databricks.com/_static/notebooks/elasticsearch.html","displayName":"Elasticsearch","workspaceFileName":"Elasticsearch Example"}],"enableStaticNotebooks":true,"enableNewLineChart":true,"sandboxForUrlSandboxFrame":"allow-scripts allow-popups allow-popups-to-escape-sandbox allow-forms","enableCssTransitions":true,"serverlessEnableElasticDisk":true,"minClusterTagKeyLength":1,"showHomepageFeaturedLinks":true,"pricingURL":"https://databricks.com/product/pricing","enableClusterEdit":true,"enableClusterAclsConfig":false,"useTempS3UrlForTableUpload":false,"notifyLastLogin":false,"enableSshKeyUIByTier":false,"enableCreateClusterOnAttach":true,"defaultAutomatedPricePerDBU":0.2,"enableNotebookGitVersioning":true,"defaultMinWorkers":2,"commandStatusDebounceMaxWait":5000,"files":"files/","feedbackEmail":"feedback@databricks.com","enableDriverLogsUI":true,"enableExperimentalCharts":false,"defaultMaxWorkers":8,"enableWorkspaceAclsConfig":false,"serverlessRunPythonAsLowPrivilegeUser":false,"dropzoneMaxFileSize":2047,"enableNewClustersList":true,"enableNewDashboardViews":true,"enableJobListPermissionFilter":true,"driverLog4jFilePrefix":"log4j","enableSingleSignOn":true,"enableMavenLibraries":true,"displayRowLimit":1000,"deltaProcessingAsyncEnabled":true,"enableSparkEnvironmentVariablesUI":false,"defaultSparkVersion":{"key":"3.5.x-scala2.11","displayName":"3.5 LTS (includes Apache Spark 2.2.1, Scala 2.11)","packageLabel":"spark-image-c919ecd682175957255cbc87041d82633406312f7b74e018e165c4fe94943b5f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},"enableNewLineChartParams":false,"deprecatedEnableStructuredDataAcls":false,"enableCustomSpotPricing":false,"enableRStudioFreeUI":false,"enableMountAclsConfig":false,"defaultAutoterminationMin":120,"useDevTierHomePage":true,"disableExportNotebook":false,"enableClusterClone":true,"enableNotebookLineNumbers":true,"enablePublishHub":false,"notebookHubUrl":"http://hub.dev.databricks.com/","commandStatusDebounceInterval":1000,"showSqlEndpoints":false,"enableNotebookDatasetInfoView":true,"defaultTagKeys":{"CLUSTER_NAME":"ClusterName","VENDOR":"Vendor","CLUSTER_TYPE":"ResourceClass","CREATOR":"Creator","CLUSTER_ID":"ClusterId"},"enableClusterAclsByTier":false,"databricksDocsBaseUrl":"https://docs.databricks.com/","azurePortalLink":"https://portal.azure.com","cloud":"AWS","customSparkVersionPrefix":"custom:","disallowAddingAdmins":true,"enableSparkConfUI":true,"enableClusterEventsUI":true,"featureTier":"DEVELOPER_BASIC_TIER","mavenCentralSearchEndpoint":"http://search.maven.org/solrsearch/select","defaultServerlessClusterModel":{"cluster_name":"","node_type_id":"i3.2xlarge","spark_version":"latest-stable-scala2.11","num_workers":null,"enable_jdbc_auto_start":true,"custom_tags":{"ResourceClass":"Serverless"},"autoscale":{"min_workers":2,"max_workers":20},"spark_conf":{"spark.databricks.cluster.profile":"serverless","spark.databricks.repl.allowedLanguages":"sql,python,r","spark.databricks.acl.enabled":"false","spark.databricks.acl.sqlOnly":"false"},"aws_attributes":{"ebs_volume_count":null,"availability":"ON_DEMAND","first_on_demand":1,"ebs_volume_type":null,"spot_bid_price_percent":100,"zone_id":"us-west-2c","ebs_volume_size":null},"autotermination_minutes":0,"enable_elastic_disk":false,"default_tags":{"Vendor":"Databricks","Creator":"liu.changsi@husky.neu.edu","ClusterName":null,"ClusterId":"<Generated after creation>"}},"enableOrgSwitcherUI":true,"bitbucketCloudBaseApiV2Url":"https://api.bitbucket.org/2.0","clustersLimit":1,"enableJdbcImport":true,"enableClusterAppsUIOnNormalClusters":false,"enableElasticDisk":false,"logfiles":"logfiles/","enableRelativeNotebookLinks":true,"enableMultiSelect":true,"homePageLogo":"login/databricks_logoTM_rgb_TM.svg","enableWebappSharding":true,"enableNotebookParamsEdit":true,"enableClusterDeltaUpdates":true,"enableSingleSignOnLogin":false,"separateTableForJobClusters":true,"ebsVolumeSizeLimitGB":{"GENERAL_PURPOSE_SSD":[100,4096],"THROUGHPUT_OPTIMIZED_HDD":[500,4096]},"enableMountAcls":false,"requireEmailUserName":true,"enableRServerless":true,"dbcFeedbackURL":"mailto:feedback@databricks.com","enableMountAclService":true,"showVersion":true,"serverlessClustersByDefault":false,"enableWorkspaceAcls":false,"maxClusterTagKeyLength":127,"gitHash":"","clusterTagReservedPrefixes":[],"tableAclsEnabledMap":{"spark.databricks.acl.dfAclsEnabled":"true"},"showWorkspaceFeaturedLinks":true,"signupUrl":"https://databricks.com/try-databricks","databricksDocsNotebookPathPrefix":"^https://docs\\.databricks\\.com/_static/notebooks/.+$","serverlessAttachEbsVolumesByDefault":false,"enableTokensConfig":false,"allowFeedbackForumAccess":true,"enablePythonVersionUI":true,"enableImportFromUrl":true,"allowDisplayHtmlByUrl":true,"enableTokens":false,"enableMiniClusters":true,"enableNewJobList":true,"enableDebugUI":false,"enableStreamingMetricsDashboard":true,"allowNonAdminUsers":true,"enableSingleSignOnByTier":false,"enableJobsRetryOnTimeout":true,"loginLogo":"/login/databricks_logoTM_rgb_TM.svg","useStandardTierUpgradeTooltips":true,"staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/358a53f93460d41f62b95cfd5ce6436b528c2b229982b8159a580fbbb91ef1fb/","enableSpotClusterType":true,"enableSparkPackages":true,"checkAadUserInWorkspaceTenant":false,"dynamicSparkVersions":true,"useIframeForHtmlResult":false,"enableClusterTagsUIByTier":false,"enableUserPromptForPendingRpc":false,"enableNotebookHistoryUI":true,"addWhitespaceAfterLastNotebookCell":true,"enableClusterLoggingUI":true,"enableDatabaseDropdownInTableUI":true,"showDebugCounters":false,"enableInstanceProfilesUI":false,"enableFolderHtmlExport":true,"homepageFeaturedLinks":[{"linkURI":"https://docs.databricks.com/_static/notebooks/gentle-introduction-to-apache-spark.html","displayName":"Introduction to Apache Spark on Databricks","icon":"img/home/Python_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/databricks-for-data-scientists.html","displayName":"Databricks for Data Scientists","icon":"img/home/Scala_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/structured-streaming-python.html","displayName":"Introduction to Structured Streaming","icon":"img/home/Python_icon.svg"}],"enableClusterStart":false,"maxImportFileVersion":5,"enableEBSVolumesUIByTier":false,"enableTableAclService":true,"removeSubCommandCodeWhenExport":true,"upgradeURL":"https://accounts.cloud.databricks.com/registration.html#login","maxAutoterminationMinutes":10000,"showResultsFromExternalSearchEngine":true,"autoterminateClustersByDefault":true,"notebookLoadingBackground":"#fff","sshContainerForwardedPort":2200,"enableServerAutoComplete":true,"enableStaticHtmlImport":true,"enableInstanceProfilesByTier":false,"showForgotPasswordLink":true,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"minAutoterminationMinutes":10,"accounts":true,"useOnDemandClustersByDefault":true,"useFramedStaticNotebooks":false,"enableNewProgressReportUI":true,"enableAutoCreateUserUI":true,"defaultCoresPerContainer":4,"showTerminationReason":true,"enableNewClustersGet":true,"showPricePerDBU":false,"showSqlProxyUI":true,"enableNotebookErrorHighlighting":true};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":4000122366180227,"name":"INFO7390_Assignment_4_Part_D Scala","language":"scala","commands":[{"version":"CommandV1","origId":4000122366180228,"guid":"5f78ecc0-ee5e-42d8-a847-a20cc059f4b7","subtype":"command","commandType":"auto","position":1.0,"command":"//Select Pick hero data to draw the graph\nval hero_names = sqlContext.sql(\"SELECT * FROM hero_names\")\ndisplay(hero_names)","commandVersion":0,"state":"error","results":null,"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:2: error: illegal start of definition\n       #Select Pick hero data to draw the graph\n       ^\n</div>","error":null,"workflows":[],"startTime":1513289759864,"submitTime":1513289759864,"finishTime":1513289764081,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"677aab1f-bdc5-497e-ae4b-14089296e9d1"},{"version":"CommandV1","origId":4000122366180230,"guid":"a82fb019-b86c-4f87-9c50-a463ba57050a","subtype":"command","commandType":"auto","position":2.0,"command":"//val radiant_team = sqlContext.sql(\"SELECT * FROM radiant_team_10000\")\nval radiant_team = sqlContext.sql(\"SELECT * FROM radiant_team_all\")\ndisplay(radiant_team)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[86,51,"team"],[86,83,"team"],[86,11,"team"],[86,67,"team"],[51,86,"team"],[51,83,"team"],[51,11,"team"],[51,67,"team"],[83,86,"team"],[83,51,"team"],[83,11,"team"],[83,67,"team"],[11,86,"team"],[11,51,"team"],[11,83,"team"],[11,67,"team"],[67,86,"team"],[67,51,"team"],[67,83,"team"],[67,11,"team"],[7,82,"team"],[7,71,"team"],[7,39,"team"],[7,21,"team"],[82,7,"team"],[82,71,"team"],[82,39,"team"],[82,21,"team"],[71,7,"team"],[71,82,"team"],[71,39,"team"],[71,21,"team"],[39,7,"team"],[39,82,"team"],[39,71,"team"],[39,21,"team"],[21,7,"team"],[21,82,"team"],[21,71,"team"],[21,39,"team"],[51,109,"team"],[51,9,"team"],[51,41,"team"],[51,27,"team"],[109,51,"team"],[109,9,"team"],[109,41,"team"],[109,27,"team"],[9,51,"team"],[9,109,"team"],[9,41,"team"],[9,27,"team"],[41,51,"team"],[41,109,"team"],[41,9,"team"],[41,27,"team"],[27,51,"team"],[27,109,"team"],[27,9,"team"],[27,41,"team"],[50,44,"team"],[50,32,"team"],[50,26,"team"],[50,39,"team"],[44,50,"team"],[44,32,"team"],[44,26,"team"],[44,39,"team"],[32,50,"team"],[32,44,"team"],[32,26,"team"],[32,39,"team"],[26,50,"team"],[26,44,"team"],[26,32,"team"],[26,39,"team"],[39,50,"team"],[39,44,"team"],[39,32,"team"],[39,26,"team"],[8,39,"team"],[8,55,"team"],[8,87,"team"],[8,69,"team"],[39,8,"team"],[39,55,"team"],[39,87,"team"],[39,69,"team"],[55,8,"team"],[55,39,"team"],[55,87,"team"],[55,69,"team"],[87,8,"team"],[87,39,"team"],[87,55,"team"],[87,69,"team"],[69,8,"team"],[69,39,"team"],[69,55,"team"],[69,87,"team"],[32,27,"team"],[32,67,"team"],[32,106,"team"],[32,71,"team"],[27,32,"team"],[27,67,"team"],[27,106,"team"],[27,71,"team"],[67,32,"team"],[67,27,"team"],[67,106,"team"],[67,71,"team"],[106,32,"team"],[106,27,"team"],[106,67,"team"],[106,71,"team"],[71,32,"team"],[71,27,"team"],[71,67,"team"],[71,106,"team"],[20,8,"team"],[20,67,"team"],[20,69,"team"],[20,100,"team"],[8,20,"team"],[8,67,"team"],[8,69,"team"],[8,100,"team"],[67,20,"team"],[67,8,"team"],[67,69,"team"],[67,100,"team"],[69,20,"team"],[69,8,"team"],[69,67,"team"],[69,100,"team"],[100,20,"team"],[100,8,"team"],[100,67,"team"],[100,69,"team"],[53,44,"team"],[53,96,"team"],[53,14,"team"],[53,74,"team"],[44,53,"team"],[44,96,"team"],[44,14,"team"],[44,74,"team"],[96,53,"team"],[96,44,"team"],[96,14,"team"],[96,74,"team"],[14,53,"team"],[14,44,"team"],[14,96,"team"],[14,74,"team"],[74,53,"team"],[74,44,"team"],[74,96,"team"],[74,14,"team"],[44,28,"team"],[44,85,"team"],[44,22,"team"],[44,30,"team"],[28,44,"team"],[28,85,"team"],[28,22,"team"],[28,30,"team"],[85,44,"team"],[85,28,"team"],[85,22,"team"],[85,30,"team"],[22,44,"team"],[22,28,"team"],[22,85,"team"],[22,30,"team"],[30,44,"team"],[30,28,"team"],[30,85,"team"],[30,22,"team"],[58,28,"team"],[58,44,"team"],[58,86,"team"],[58,39,"team"],[28,58,"team"],[28,44,"team"],[28,86,"team"],[28,39,"team"],[44,58,"team"],[44,28,"team"],[44,86,"team"],[44,39,"team"],[86,58,"team"],[86,28,"team"],[86,44,"team"],[86,39,"team"],[39,58,"team"],[39,28,"team"],[39,44,"team"],[39,86,"team"],[35,50,"team"],[35,44,"team"],[35,69,"team"],[35,29,"team"],[50,35,"team"],[50,44,"team"],[50,69,"team"],[50,29,"team"],[44,35,"team"],[44,50,"team"],[44,69,"team"],[44,29,"team"],[69,35,"team"],[69,50,"team"],[69,44,"team"],[69,29,"team"],[29,35,"team"],[29,50,"team"],[29,44,"team"],[29,69,"team"],[94,28,"team"],[94,3,"team"],[94,11,"team"],[94,50,"team"],[28,94,"team"],[28,3,"team"],[28,11,"team"],[28,50,"team"],[3,94,"team"],[3,28,"team"],[3,11,"team"],[3,50,"team"],[11,94,"team"],[11,28,"team"],[11,3,"team"],[11,50,"team"],[50,94,"team"],[50,28,"team"],[50,3,"team"],[50,11,"team"],[93,74,"team"],[93,22,"team"],[93,101,"team"],[93,41,"team"],[74,93,"team"],[74,22,"team"],[74,101,"team"],[74,41,"team"],[22,93,"team"],[22,74,"team"],[22,101,"team"],[22,41,"team"],[101,93,"team"],[101,74,"team"],[101,22,"team"],[101,41,"team"],[41,93,"team"],[41,74,"team"],[41,22,"team"],[41,101,"team"],[81,100,"team"],[81,25,"team"],[81,63,"team"],[81,32,"team"],[100,81,"team"],[100,25,"team"],[100,63,"team"],[100,32,"team"],[25,81,"team"],[25,100,"team"],[25,63,"team"],[25,32,"team"],[63,81,"team"],[63,100,"team"],[63,25,"team"],[63,32,"team"],[32,81,"team"],[32,100,"team"],[32,25,"team"],[32,63,"team"],[75,1,"team"],[75,44,"team"],[75,7,"team"],[75,28,"team"],[1,75,"team"],[1,44,"team"],[1,7,"team"],[1,28,"team"],[44,75,"team"],[44,1,"team"],[44,7,"team"],[44,28,"team"],[7,75,"team"],[7,1,"team"],[7,44,"team"],[7,28,"team"],[28,75,"team"],[28,1,"team"],[28,44,"team"],[28,7,"team"],[20,104,"team"],[20,2,"team"],[20,93,"team"],[20,34,"team"],[104,20,"team"],[104,2,"team"],[104,93,"team"],[104,34,"team"],[2,20,"team"],[2,104,"team"],[2,93,"team"],[2,34,"team"],[93,20,"team"],[93,104,"team"],[93,2,"team"],[93,34,"team"],[34,20,"team"],[34,104,"team"],[34,2,"team"],[34,93,"team"],[2,86,"team"],[2,81,"team"],[2,4,"team"],[2,14,"team"],[86,2,"team"],[86,81,"team"],[86,4,"team"],[86,14,"team"],[81,2,"team"],[81,86,"team"],[81,4,"team"],[81,14,"team"],[4,2,"team"],[4,86,"team"],[4,81,"team"],[4,14,"team"],[14,2,"team"],[14,86,"team"],[14,81,"team"],[14,4,"team"],[62,25,"team"],[62,71,"team"],[62,72,"team"],[62,46,"team"],[25,62,"team"],[25,71,"team"],[25,72,"team"],[25,46,"team"],[71,62,"team"],[71,25,"team"],[71,72,"team"],[71,46,"team"],[72,62,"team"],[72,25,"team"],[72,71,"team"],[72,46,"team"],[46,62,"team"],[46,25,"team"],[46,71,"team"],[46,72,"team"],[75,68,"team"],[75,46,"team"],[75,107,"team"],[75,72,"team"],[68,75,"team"],[68,46,"team"],[68,107,"team"],[68,72,"team"],[46,75,"team"],[46,68,"team"],[46,107,"team"],[46,72,"team"],[107,75,"team"],[107,68,"team"],[107,46,"team"],[107,72,"team"],[72,75,"team"],[72,68,"team"],[72,46,"team"],[72,107,"team"],[36,76,"team"],[36,7,"team"],[36,19,"team"],[36,91,"team"],[76,36,"team"],[76,7,"team"],[76,19,"team"],[76,91,"team"],[7,36,"team"],[7,76,"team"],[7,19,"team"],[7,91,"team"],[19,36,"team"],[19,76,"team"],[19,7,"team"],[19,91,"team"],[91,36,"team"],[91,76,"team"],[91,7,"team"],[91,19,"team"],[71,59,"team"],[71,95,"team"],[71,21,"team"],[71,7,"team"],[59,71,"team"],[59,95,"team"],[59,21,"team"],[59,7,"team"],[95,71,"team"],[95,59,"team"],[95,21,"team"],[95,7,"team"],[21,71,"team"],[21,59,"team"],[21,95,"team"],[21,7,"team"],[7,71,"team"],[7,59,"team"],[7,95,"team"],[7,21,"team"],[106,84,"team"],[106,102,"team"],[106,50,"team"],[106,1,"team"],[84,106,"team"],[84,102,"team"],[84,50,"team"],[84,1,"team"],[102,106,"team"],[102,84,"team"],[102,50,"team"],[102,1,"team"],[50,106,"team"],[50,84,"team"],[50,102,"team"],[50,1,"team"],[1,106,"team"],[1,84,"team"],[1,102,"team"],[1,50,"team"],[9,7,"team"],[9,32,"team"],[9,93,"team"],[9,21,"team"],[7,9,"team"],[7,32,"team"],[7,93,"team"],[7,21,"team"],[32,9,"team"],[32,7,"team"],[32,93,"team"],[32,21,"team"],[93,9,"team"],[93,7,"team"],[93,32,"team"],[93,21,"team"],[21,9,"team"],[21,7,"team"],[21,32,"team"],[21,93,"team"],[68,100,"team"],[68,47,"team"],[68,1,"team"],[68,62,"team"],[100,68,"team"],[100,47,"team"],[100,1,"team"],[100,62,"team"],[47,68,"team"],[47,100,"team"],[47,1,"team"],[47,62,"team"],[1,68,"team"],[1,100,"team"],[1,47,"team"],[1,62,"team"],[62,68,"team"],[62,100,"team"],[62,47,"team"],[62,1,"team"],[87,39,"team"],[87,85,"team"],[87,74,"team"],[87,62,"team"],[39,87,"team"],[39,85,"team"],[39,74,"team"],[39,62,"team"],[85,87,"team"],[85,39,"team"],[85,74,"team"],[85,62,"team"],[74,87,"team"],[74,39,"team"],[74,85,"team"],[74,62,"team"],[62,87,"team"],[62,39,"team"],[62,85,"team"],[62,74,"team"],[21,23,"team"],[21,109,"team"],[21,43,"team"],[21,104,"team"],[23,21,"team"],[23,109,"team"],[23,43,"team"],[23,104,"team"],[109,21,"team"],[109,23,"team"],[109,43,"team"],[109,104,"team"],[43,21,"team"],[43,23,"team"],[43,109,"team"],[43,104,"team"],[104,21,"team"],[104,23,"team"],[104,109,"team"],[104,43,"team"],[32,70,"team"],[32,36,"team"],[32,46,"team"],[32,11,"team"],[70,32,"team"],[70,36,"team"],[70,46,"team"],[70,11,"team"],[36,32,"team"],[36,70,"team"],[36,46,"team"],[36,11,"team"],[46,32,"team"],[46,70,"team"],[46,36,"team"],[46,11,"team"],[11,32,"team"],[11,70,"team"],[11,36,"team"],[11,46,"team"],[102,104,"team"],[102,77,"team"],[102,28,"team"],[102,53,"team"],[104,102,"team"],[104,77,"team"],[104,28,"team"],[104,53,"team"],[77,102,"team"],[77,104,"team"],[77,28,"team"],[77,53,"team"],[28,102,"team"],[28,104,"team"],[28,77,"team"],[28,53,"team"],[53,102,"team"],[53,104,"team"],[53,77,"team"],[53,28,"team"],[86,1,"team"],[86,102,"team"],[86,46,"team"],[86,71,"team"],[1,86,"team"],[1,102,"team"],[1,46,"team"],[1,71,"team"],[102,86,"team"],[102,1,"team"],[102,46,"team"],[102,71,"team"],[46,86,"team"],[46,1,"team"],[46,102,"team"],[46,71,"team"],[71,86,"team"],[71,1,"team"],[71,102,"team"],[71,46,"team"],[106,100,"team"],[106,9,"team"],[106,14,"team"],[106,62,"team"],[100,106,"team"],[100,9,"team"],[100,14,"team"],[100,62,"team"],[9,106,"team"],[9,100,"team"],[9,14,"team"],[9,62,"team"],[14,106,"team"],[14,100,"team"],[14,9,"team"],[14,62,"team"],[62,106,"team"],[62,100,"team"],[62,9,"team"],[62,14,"team"],[53,5,"team"],[53,46,"team"],[53,4,"team"],[53,42,"team"],[5,53,"team"],[5,46,"team"],[5,4,"team"],[5,42,"team"],[46,53,"team"],[46,5,"team"],[46,4,"team"],[46,42,"team"],[4,53,"team"],[4,5,"team"],[4,46,"team"],[4,42,"team"],[42,53,"team"],[42,5,"team"],[42,46,"team"],[42,4,"team"],[48,50,"team"],[48,46,"team"],[48,75,"team"],[48,2,"team"],[50,48,"team"],[50,46,"team"],[50,75,"team"],[50,2,"team"],[46,48,"team"],[46,50,"team"],[46,75,"team"],[46,2,"team"],[75,48,"team"],[75,50,"team"],[75,46,"team"],[75,2,"team"],[2,48,"team"],[2,50,"team"],[2,46,"team"],[2,75,"team"],[60,67,"team"],[60,50,"team"],[60,34,"team"],[60,99,"team"],[67,60,"team"],[67,50,"team"],[67,34,"team"],[67,99,"team"],[50,60,"team"],[50,67,"team"],[50,34,"team"],[50,99,"team"],[34,60,"team"],[34,67,"team"],[34,50,"team"],[34,99,"team"],[99,60,"team"],[99,67,"team"],[99,50,"team"],[99,34,"team"],[76,9,"team"],[76,83,"team"],[76,101,"team"],[76,73,"team"],[9,76,"team"],[9,83,"team"],[9,101,"team"],[9,73,"team"],[83,76,"team"],[83,9,"team"],[83,101,"team"],[83,73,"team"],[101,76,"team"],[101,9,"team"],[101,83,"team"],[101,73,"team"],[73,76,"team"],[73,9,"team"],[73,83,"team"],[73,101,"team"],[112,50,"team"],[112,109,"team"],[112,74,"team"],[112,8,"team"],[50,112,"team"],[50,109,"team"],[50,74,"team"],[50,8,"team"],[109,112,"team"],[109,50,"team"],[109,74,"team"],[109,8,"team"],[74,112,"team"],[74,50,"team"],[74,109,"team"],[74,8,"team"],[8,112,"team"],[8,50,"team"],[8,109,"team"],[8,74,"team"],[98,74,"team"],[98,58,"team"],[98,28,"team"],[98,75,"team"],[74,98,"team"],[74,58,"team"],[74,28,"team"],[74,75,"team"],[58,98,"team"],[58,74,"team"],[58,28,"team"],[58,75,"team"],[28,98,"team"],[28,74,"team"],[28,58,"team"],[28,75,"team"],[75,98,"team"],[75,74,"team"],[75,58,"team"],[75,28,"team"],[84,42,"team"],[84,11,"team"],[84,20,"team"],[84,99,"team"],[42,84,"team"],[42,11,"team"],[42,20,"team"],[42,99,"team"],[11,84,"team"],[11,42,"team"],[11,20,"team"],[11,99,"team"],[20,84,"team"],[20,42,"team"],[20,11,"team"],[20,99,"team"],[99,84,"team"],[99,42,"team"],[99,11,"team"],[99,20,"team"],[7,89,"team"],[7,86,"team"],[7,39,"team"],[7,81,"team"],[89,7,"team"],[89,86,"team"],[89,39,"team"],[89,81,"team"],[86,7,"team"],[86,89,"team"],[86,39,"team"],[86,81,"team"],[39,7,"team"],[39,89,"team"],[39,86,"team"],[39,81,"team"],[81,7,"team"],[81,89,"team"],[81,86,"team"],[81,39,"team"],[21,86,"team"],[21,72,"team"],[21,74,"team"],[21,52,"team"],[86,21,"team"],[86,72,"team"],[86,74,"team"],[86,52,"team"],[72,21,"team"],[72,86,"team"],[72,74,"team"],[72,52,"team"],[74,21,"team"],[74,86,"team"],[74,72,"team"],[74,52,"team"],[52,21,"team"],[52,86,"team"],[52,72,"team"],[52,74,"team"],[7,110,"team"],[7,93,"team"],[7,21,"team"],[7,69,"team"],[110,7,"team"],[110,93,"team"],[110,21,"team"],[110,69,"team"],[93,7,"team"],[93,110,"team"],[93,21,"team"],[93,69,"team"],[21,7,"team"],[21,110,"team"],[21,93,"team"],[21,69,"team"],[69,7,"team"],[69,110,"team"],[69,93,"team"],[69,21,"team"],[70,72,"team"],[70,71,"team"],[70,11,"team"],[70,25,"team"],[72,70,"team"],[72,71,"team"],[72,11,"team"],[72,25,"team"],[71,70,"team"],[71,72,"team"],[71,11,"team"],[71,25,"team"],[11,70,"team"],[11,72,"team"],[11,71,"team"],[11,25,"team"],[25,70,"team"],[25,72,"team"],[25,71,"team"],[25,11,"team"],[42,104,"team"],[42,11,"team"],[42,4,"team"],[42,30,"team"],[104,42,"team"],[104,11,"team"],[104,4,"team"],[104,30,"team"],[11,42,"team"],[11,104,"team"],[11,4,"team"],[11,30,"team"],[4,42,"team"],[4,104,"team"],[4,11,"team"],[4,30,"team"],[30,42,"team"],[30,104,"team"],[30,11,"team"],[30,4,"team"],[62,51,"team"],[62,18,"team"],[62,84,"team"],[62,25,"team"],[51,62,"team"],[51,18,"team"],[51,84,"team"],[51,25,"team"],[18,62,"team"],[18,51,"team"],[18,84,"team"],[18,25,"team"],[84,62,"team"],[84,51,"team"],[84,18,"team"],[84,25,"team"],[25,62,"team"],[25,51,"team"],[25,18,"team"],[25,84,"team"],[21,59,"team"],[21,99,"team"],[21,44,"team"],[21,30,"team"],[59,21,"team"],[59,99,"team"],[59,44,"team"],[59,30,"team"],[99,21,"team"],[99,59,"team"],[99,44,"team"],[99,30,"team"],[44,21,"team"],[44,59,"team"],[44,99,"team"],[44,30,"team"],[30,21,"team"],[30,59,"team"],[30,99,"team"],[30,44,"team"],[40,56,"team"],[40,1,"team"],[40,69,"team"],[40,22,"team"],[56,40,"team"],[56,1,"team"],[56,69,"team"],[56,22,"team"],[1,40,"team"],[1,56,"team"],[1,69,"team"],[1,22,"team"],[69,40,"team"],[69,56,"team"],[69,1,"team"],[69,22,"team"],[22,40,"team"],[22,56,"team"],[22,1,"team"],[22,69,"team"],[110,48,"team"],[110,30,"team"],[110,27,"team"],[110,102,"team"],[48,110,"team"],[48,30,"team"],[48,27,"team"],[48,102,"team"],[30,110,"team"],[30,48,"team"],[30,27,"team"],[30,102,"team"],[27,110,"team"],[27,48,"team"],[27,30,"team"],[27,102,"team"],[102,110,"team"],[102,48,"team"],[102,30,"team"],[102,27,"team"],[28,86,"team"],[28,67,"team"],[28,16,"team"],[28,23,"team"],[86,28,"team"],[86,67,"team"],[86,16,"team"],[86,23,"team"],[67,28,"team"],[67,86,"team"],[67,16,"team"],[67,23,"team"],[16,28,"team"],[16,86,"team"],[16,67,"team"],[16,23,"team"],[23,28,"team"],[23,86,"team"],[23,67,"team"],[23,16,"team"],[109,1,"team"],[109,70,"team"],[109,85,"team"],[109,25,"team"],[1,109,"team"],[1,70,"team"],[1,85,"team"],[1,25,"team"],[70,109,"team"],[70,1,"team"],[70,85,"team"],[70,25,"team"],[85,109,"team"],[85,1,"team"],[85,70,"team"],[85,25,"team"],[25,109,"team"],[25,1,"team"],[25,70,"team"],[25,85,"team"],[76,83,"team"],[76,74,"team"],[76,44,"team"],[76,16,"team"],[83,76,"team"],[83,74,"team"],[83,44,"team"],[83,16,"team"],[74,76,"team"],[74,83,"team"],[74,44,"team"],[74,16,"team"],[44,76,"team"],[44,83,"team"],[44,74,"team"],[44,16,"team"],[16,76,"team"],[16,83,"team"],[16,74,"team"],[16,44,"team"],[69,30,"team"],[69,39,"team"],[69,42,"team"],[69,29,"team"],[30,69,"team"],[30,39,"team"],[30,42,"team"],[30,29,"team"],[39,69,"team"],[39,30,"team"],[39,42,"team"],[39,29,"team"],[42,69,"team"],[42,30,"team"],[42,39,"team"],[42,29,"team"],[29,69,"team"],[29,30,"team"],[29,39,"team"],[29,42,"team"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"hero_id_src","type":"\"integer\"","metadata":"{}"},{"name":"hero_id_dist","type":"\"integer\"","metadata":"{}"},{"name":"team","type":"\"string\"","metadata":"{}"}],"overflow":true,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1513048744051,"submitTime":1513048740514,"finishTime":1513048744312,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"374df307-beb7-40d0-9a8c-3aef2e3610db"},{"version":"CommandV1","origId":4000122366180231,"guid":"33ae9ea9-cc90-43f3-923a-15965b2c6585","subtype":"command","commandType":"auto","position":3.0,"command":"import org.apache.spark.graphx._\nimport org.apache.spark.rdd.RDD\n\nval hero_table = hero_names\n  .selectExpr(\"float(hero_id) as hero_id\", \"localized_name as name\")\n  .distinct()\n/**\nval radiant_team_data = radiant_team\n  .join(hero_table, radiant_team(\"hero_id_src\") === hero_table(\"hero_id\"))\n  .withColumnRenamed(\"hero_id\", \"hero_src_id\")\n  .drop(\"name\")\n  .join(hero_table, radiant_team(\"hero_id_dist\") === hero_table(\"hero_id\"))\n  .withColumnRenamed(\"hero_id\", \"hero_dist_id\")\n  .drop(\"name\")\n  **/","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.graphx._\nimport org.apache.spark.rdd.RDD\nhero_table: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [hero_id: float, name: string]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:60: error: not found: value hhero_tableeros\n         .join(hhero_tableeros, radiant_team(&quot;hero_id_dist&quot;) === hero_table(&quot;hero_id&quot;))\n               ^\n</div>","error":null,"workflows":[],"startTime":1513048744319,"submitTime":1513048740630,"finishTime":1513048744463,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f16b99b0-8513-420a-9d2f-be6d1a732d32"},{"version":"CommandV1","origId":4000122366180234,"guid":"a47b0589-d2f6-4d0e-899a-2c12dd0c653b","subtype":"command","commandType":"auto","position":3.25,"command":"val heros = radiant_team\n  .select(\"hero_id_src\", \"hero_id_dist\")\n  .rdd  \n  .distinct() // helps filter out duplicate trips\n  .flatMap(x => Iterable(x(0).asInstanceOf[Number].longValue, x(1).asInstanceOf[Number].longValue)) // helps us maintain types\n  .distinct()\n  .toDF() // return to a DF to make merging + joining easier\n\nheros.take(1) // this is just a station_id at this point\n//display(heros)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">heros: org.apache.spark.sql.DataFrame = [value: bigint]\nres2: Array[org.apache.spark.sql.Row] = Array([84])\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:11: error: ';' expected but '#' found.\n       #display(heros)\n       ^\n</div>","error":null,"workflows":[],"startTime":1513048744467,"submitTime":1513048740744,"finishTime":1513048746348,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7e237a7b-683f-4e93-980f-5d0c0f98485c"},{"version":"CommandV1","origId":4000122366180233,"guid":"2927e7b0-ee9d-4a80-bca5-501e30b66d64","subtype":"command","commandType":"auto","position":3.5,"command":"val heroVertices: RDD[(VertexId, String)] = heros\n  .join(hero_table, heros(\"value\") === hero_table(\"hero_id\"))\n  .select(\"hero_id\", \"name\")\n  .rdd\n  .map(row => (row(0).asInstanceOf[Number].longValue, row(1).asInstanceOf[String])) // maintain type information\n\nheroVertices.take(1)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">heroVertices: org.apache.spark.rdd.RDD[(org.apache.spark.graphx.VertexId, String)] = MapPartitionsRDD[1818] at map at &lt;console&gt;:49\nres3: Array[(org.apache.spark.graphx.VertexId, String)] = Array((84,Ogre Magi))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"org.apache.spark.sql.AnalysisException: resolved attribute(s) hero_id#1453 missing from hero_id_src#457,value#1433L,hero_src_id#1274,hero_dist_id#1308,hero_id_dist#458,team#459 in operator !Join Inner, (cast(value#1433L as float) = hero_id#1453);;","error":"<div class=\"ansiout\">!Join Inner, (cast(value#1433L as float) = hero_id#1453)\n:- Project [hero_id_src#457, hero_id_dist#458, team#459, hero_src_id#1274, hero_dist_id#1308]\n:  +- Project [hero_id_src#457, hero_id_dist#458, team#459, hero_src_id#1274, hero_id#1249 AS hero_dist_id#1308, name#1250]\n:     +- Join Inner, (cast(hero_id_dist#458 as float) = hero_id#1249)\n:        :- Project [hero_id_src#457, hero_id_dist#458, team#459, hero_src_id#1274]\n:        :  +- Project [hero_id_src#457, hero_id_dist#458, team#459, hero_id#1249 AS hero_src_id#1274, name#1250]\n:        :     +- Join Inner, (cast(hero_id_src#457 as float) = hero_id#1249)\n:        :        :- Project [hero_id_src#457, hero_id_dist#458, team#459]\n:        :        :  +- SubqueryAlias radiant_team_10000\n:        :        :     +- Relation[hero_id_src#457,hero_id_dist#458,team#459] csv\n:        :        +- Aggregate [hero_id#1249, name#1250], [hero_id#1249, name#1250]\n:        :           +- Project [cast(hero_id#138 as float) AS hero_id#1249, localized_name#139 AS name#1250]\n:        :              +- Project [hero_id#138, localized_name#139]\n:        :                 +- SubqueryAlias hero_names\n:        :                    +- Relation[hero_id#138,localized_name#139] csv\n:        +- Aggregate [hero_id#1249, name#1250], [hero_id#1249, name#1250]\n:           +- Project [cast(hero_id#138 as float) AS hero_id#1249, localized_name#139 AS name#1250]\n:              +- Project [hero_id#138, localized_name#139]\n:                 +- SubqueryAlias hero_names\n:                    +- Relation[hero_id#138,localized_name#139] csv\n+- LogicalRDD [value#1433L]\n\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$class.failAnalysis(CheckAnalysis.scala:40)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.failAnalysis(Analyzer.scala:58)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1.apply(CheckAnalysis.scala:293)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1.apply(CheckAnalysis.scala:67)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:126)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$class.checkAnalysis(CheckAnalysis.scala:67)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.checkAnalysis(Analyzer.scala:58)\n\tat org.apache.spark.sql.execution.QueryExecution.assertAnalyzed(QueryExecution.scala:49)\n\tat org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:64)\n\tat org.apache.spark.sql.Dataset.org$apache$spark$sql$Dataset$$withPlan(Dataset.scala:2608)\n\tat org.apache.spark.sql.Dataset.join(Dataset.scala:696)\n\tat org.apache.spark.sql.Dataset.join(Dataset.scala:662)</div>","workflows":[],"startTime":1513048746352,"submitTime":1513048740859,"finishTime":1513048747018,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d23cb9c3-5259-41cf-9808-69d30ed74c95"},{"version":"CommandV1","origId":4000122366180235,"guid":"21a39c0a-4616-40d9-a7c3-63c02df6a390","subtype":"command","commandType":"auto","position":3.75,"command":"val teamEdges:RDD[Edge[Long]] = radiant_team\n  .select(\"hero_id_src\", \"hero_id_dist\")\n  .rdd\n  .map(row => Edge(row(0).asInstanceOf[Number].longValue, row(1).asInstanceOf[Number].longValue, 1))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">teamEdges: org.apache.spark.rdd.RDD[org.apache.spark.graphx.Edge[Long]] = MapPartitionsRDD[1823] at map at &lt;console&gt;:42\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"org.apache.spark.sql.AnalysisException: cannot resolve '`hero_src_id`' given input columns: [hero_id_src, hero_id_dist, team];;","error":"<div class=\"ansiout\">'Project ['hero_src_id, 'hero_dist_id]\n+- Project [hero_id_src#457, hero_id_dist#458, team#459]\n   +- SubqueryAlias radiant_team_10000\n      +- Relation[hero_id_src#457,hero_id_dist#458,team#459] csv\n\n\tat org.apache.spark.sql.catalyst.analysis.package$AnalysisErrorAt.failAnalysis(package.scala:42)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1$$anonfun$apply$2.applyOrElse(CheckAnalysis.scala:77)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1$$anonfun$apply$2.applyOrElse(CheckAnalysis.scala:74)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$transformUp$1.apply(TreeNode.scala:308)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$transformUp$1.apply(TreeNode.scala:308)\n\tat org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(TreeNode.scala:69)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.transformUp(TreeNode.scala:307)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan.transformExpressionUp$1(QueryPlan.scala:282)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan.org$apache$spark$sql$catalyst$plans$QueryPlan$$recursiveTransform$2(QueryPlan.scala:292)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan$$anonfun$org$apache$spark$sql$catalyst$plans$QueryPlan$$recursiveTransform$2$1.apply(QueryPlan.scala:296)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:244)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:244)\n\tat scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)\n\tat scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:47)\n\tat scala.collection.TraversableLike$class.map(TraversableLike.scala:244)\n\tat scala.collection.AbstractTraversable.map(Traversable.scala:105)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan.org$apache$spark$sql$catalyst$plans$QueryPlan$$recursiveTransform$2(QueryPlan.scala:296)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan$$anonfun$7.apply(QueryPlan.scala:301)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.mapProductIterator(TreeNode.scala:186)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan.transformExpressionsUp(QueryPlan.scala:301)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1.apply(CheckAnalysis.scala:74)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1.apply(CheckAnalysis.scala:67)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:126)\n\tat org.apache.spark.sql.catalyst.analysis.CheckAnalysis$class.checkAnalysis(CheckAnalysis.scala:67)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.checkAnalysis(Analyzer.scala:58)\n\tat org.apache.spark.sql.execution.QueryExecution.assertAnalyzed(QueryExecution.scala:49)\n\tat org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:64)\n\tat org.apache.spark.sql.Dataset.org$apache$spark$sql$Dataset$$withPlan(Dataset.scala:2608)\n\tat org.apache.spark.sql.Dataset.select(Dataset.scala:969)\n\tat org.apache.spark.sql.Dataset.select(Dataset.scala:987)</div>","workflows":[],"startTime":1513048747024,"submitTime":1513048740967,"finishTime":1513048747164,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a1f2952b-0f7f-4f81-ab8e-086319c9ec51"},{"version":"CommandV1","origId":4000122366180236,"guid":"55eb3a8f-6ccb-4804-afea-60e34d3f28cb","subtype":"command","commandType":"auto","position":3.875,"command":"val defaultHero = (\"Missing Hero\") \nval heroGraph = Graph(heroVertices, teamEdges, defaultHero)\nheroGraph.cache()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">defaultHero: String = Missing Hero\nheroGraph: org.apache.spark.graphx.Graph[String,Long] = org.apache.spark.graphx.impl.GraphImpl@137f04f0\nres4: org.apache.spark.graphx.Graph[String,Long] = org.apache.spark.graphx.impl.GraphImpl@137f04f0\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1513048747168,"submitTime":1513048741078,"finishTime":1513048747257,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"297b64eb-8bde-4e6c-88dc-ef8ad6063057"},{"version":"CommandV1","origId":4000122366180232,"guid":"04544d17-c886-4b21-9922-3ac2a5226f6b","subtype":"command","commandType":"auto","position":4.0,"command":"println(\"Total Number of Heros: \" + heroGraph.numVertices)\nprintln(\"Total Number of Picks with team: \" + heroGraph.numEdges)\n\nprintln(\"Total Number of picks in Original Data: \" + radiant_team.count)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Total Number of Heros: 111\nTotal Number of Picks with team: 999998\nTotal Number of picks in Original Data: 999998\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:58: error: not found: value tripData\n              println(&quot;Total Number of picks in Original Data: &quot; + tripData.count)\n                                                                   ^\n</div>","error":null,"workflows":[],"startTime":1513048747262,"submitTime":1513048741186,"finishTime":1513048749325,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f3fe1b8b-833d-499e-9453-fff27a9ffc75"},{"version":"CommandV1","origId":4000122366180237,"guid":"cb844b5a-3add-4a7a-9c6a-6a407b382003","subtype":"command","commandType":"auto","position":5.0,"command":"val ranks = heroGraph.pageRank(0.0001).vertices\nranks\n  .join(heroVertices)\n  .sortBy(_._2._1, ascending=false) // sort by the rank\n  .take(10) // get the top 10\n  .foreach(x => println(x._2._2))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Windranger\nShadow Fiend\nInvoker\nEarthshaker\nSlardar\nQueen of Pain\nTusk\nJuggernaut\nAlchemist\nPudge\nranks: org.apache.spark.graphx.VertexRDD[Double] = VertexRDDImpl[2628] at RDD at VertexRDD.scala:55\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:57: error: not found: value stationVertices\n                .join(stationVertices)\n                      ^\n</div>","error":null,"workflows":[],"startTime":1513048749330,"submitTime":1513048741304,"finishTime":1513048758012,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5e155c0b-8a49-4648-af33-83d19ef78c82"},{"version":"CommandV1","origId":4000122366180238,"guid":"eeacc6af-79b0-4a04-aef4-63cc1cd50a6a","subtype":"command","commandType":"auto","position":6.0,"command":"heroGraph\n  .groupEdges((edge1, edge2) => edge1 + edge2)\n  .triplets\n  .sortBy(_.attr, ascending=false)\n  .map(triplet => \n    \"There were \" + triplet.attr.toString + \" picks with \" + triplet.srcAttr + \" and \" + triplet.dstAttr + \".\")\n  .take(20)\n  .foreach(println)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">There were 514 picks with Earthshaker and Windranger.\nThere were 514 picks with Windranger and Earthshaker.\nThere were 454 picks with Earthshaker and Shadow Fiend.\nThere were 454 picks with Shadow Fiend and Earthshaker.\nThere were 447 picks with Earthshaker and Shadow Fiend.\nThere were 447 picks with Shadow Fiend and Earthshaker.\nThere were 442 picks with Earthshaker and Windranger.\nThere were 442 picks with Windranger and Earthshaker.\nThere were 427 picks with Shadow Fiend and Windranger.\nThere were 427 picks with Windranger and Shadow Fiend.\nThere were 419 picks with Shadow Fiend and Slardar.\nThere were 419 picks with Slardar and Shadow Fiend.\nThere were 406 picks with Windranger and Slardar.\nThere were 406 picks with Slardar and Windranger.\nThere were 405 picks with Shadow Fiend and Windranger.\nThere were 405 picks with Windranger and Shadow Fiend.\nThere were 388 picks with Shadow Fiend and Slardar.\nThere were 388 picks with Slardar and Shadow Fiend.\nThere were 387 picks with Juggernaut and Windranger.\nThere were 387 picks with Windranger and Juggernaut.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1513048758018,"submitTime":1513048741409,"finishTime":1513048758443,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"dd1a02e2-ac99-44e9-8de9-5fb753c7fc9f"},{"version":"CommandV1","origId":4000122366180239,"guid":"3ded897f-1ca3-4e8c-8855-eeae68d441d6","subtype":"command","commandType":"auto","position":7.0,"command":"heroGraph\n  .outDegrees // out degrees\n  .join(heroVertices)\n  .sortBy(_._2._1, ascending=false)\n  .take(10)\n  .foreach(x => println(x._2._2 + \" has \" + x._2._1 + \" out degrees (with teammates).\"))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Windranger has 41296 out degrees (with teammates).\nShadow Fiend has 36032 out degrees (with teammates).\nEarthshaker has 23352 out degrees (with teammates).\nInvoker has 23296 out degrees (with teammates).\nSlardar has 21780 out degrees (with teammates).\nTusk has 20828 out degrees (with teammates).\nQueen of Pain has 20760 out degrees (with teammates).\nJuggernaut has 20548 out degrees (with teammates).\nAlchemist has 19852 out degrees (with teammates).\nPudge has 19260 out degrees (with teammates).\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1513048758447,"submitTime":1513048741518,"finishTime":1513048758645,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"69a9f095-5f4d-43cf-a3ed-8640593596b0"},{"version":"CommandV1","origId":4000122366180240,"guid":"d93d4854-b1e3-45c8-af39-41aa342275ca","subtype":"command","commandType":"auto","position":8.0,"command":"heroGraph\n  .inDegrees\n  .join(heroGraph.outDegrees) // join with out Degrees\n  .join(heroVertices) // join with our other stations\n  .map(x => (x._2._1._1.toDouble/x._2._1._2.toDouble, x._2._2)) // ratio of in to out\n  .sortBy(_._1, ascending=false)\n  .take(5)\n  .foreach(x => println(x._2 + \" has a in/out degree ratio of \" + x._1))\n//just show the example here, because picks are always strong connection between two nodes.\n//e.g. Chaos Knight is Ogre Magi's team mate, so that Ogre Magi is Chaos Knight's team mate.\n//So, all results are equal to 1 (i/o ratio)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Ogre Magi has a in/out degree ratio of 1.0\nQueen of Pain has a in/out degree ratio of 1.0\nCentaur Warrunner has a in/out degree ratio of 1.0\nChaos Knight has a in/out degree ratio of 1.0\nRazor has a in/out degree ratio of 1.0\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1513048758650,"submitTime":1513048741635,"finishTime":1513048758939,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"98d6b58b-ad9d-4a69-984b-c1402fd81436"},{"version":"CommandV1","origId":4000122366180241,"guid":"dec5eed6-5390-4f81-b2da-c64614dfd5d9","subtype":"command","commandType":"auto","position":9.0,"command":"heroGraph\n  .inDegrees\n  .join(heroGraph.inDegrees) // join with out Degrees\n  .join(heroVertices) // join with our other stations\n  .map(x => (x._2._1._1.toDouble/x._2._1._2.toDouble, x._2._2)) // ratio of in to out\n  .sortBy(_._1)\n  .take(5)\n  .foreach(x => println(x._2 + \" has a in/out degree ratio of \" + x._1))\n//Same result as above. No matter the I/O ratio is, all equals to 1 in our DoTA2 Dataset.","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Ogre Magi has a in/out degree ratio of 1.0\nQueen of Pain has a in/out degree ratio of 1.0\nCentaur Warrunner has a in/out degree ratio of 1.0\nChaos Knight has a in/out degree ratio of 1.0\nRazor has a in/out degree ratio of 1.0\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1513048758943,"submitTime":1513048741752,"finishTime":1513048759161,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ec02efee-c331-4322-8fee-15b5ca7b3fae"},{"version":"CommandV1","origId":4000122366180242,"guid":"118d7ac1-0530-4948-a1ae-8e258b347377","subtype":"command","commandType":"auto","position":10.0,"command":"//And GraphFrame\nimport org.apache.spark.sql._\nimport org.apache.spark.sql.functions._\n\nimport org.graphframes._\n/**\n$SPARK_HOME/bin/spark-shell --packages graphframes:graphframes:0.5.0-spark2.1-s_2.11\ninstalled Version: 0.5.0-spark2.0-s_2.10 ( dbf26b | zip | jar ) / Date: 2017-05-18 / License: Apache-2.0 / Scala version: 2.10\nfrom https://spark-packages.org/package/graphframes/graphframes\n**/\n\nval hero_names = sqlContext.sql(\"SELECT * FROM hero_names\")\n\nval heroVertices = hero_names\n  .withColumnRenamed(\"localized_name\", \"name\")\n  .withColumnRenamed(\"hero_id\", \"id\")\n  .distinct()\n\nval radiant_team_all = sqlContext.sql(\"SELECT * FROM radiant_team_all\")\n\nval teamEdges = radiant_team_all\n  .withColumnRenamed(\"hero_id_src\", \"src\")\n  .withColumnRenamed(\"hero_id_dist\", \"dst\")\n\nval heroGraph = GraphFrame(heroVertices, teamEdges)\n\nteamEdges.cache()\nheroVertices.cache()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.sql._\nimport org.apache.spark.sql.functions._\nimport org.graphframes._\nhero_names: org.apache.spark.sql.DataFrame = [hero_id: int, localized_name: string]\nheroVertices: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [id: int, name: string]\nradiant_team_all: org.apache.spark.sql.DataFrame = [hero_id_src: int, hero_id_dist: int ... 1 more field]\nteamEdges: org.apache.spark.sql.DataFrame = [src: int, dst: int ... 1 more field]\nheroGraph: org.graphframes.GraphFrame = GraphFrame(v:[id: int, name: string], e:[src: int, dst: int ... 1 more field])\nres11: heroVertices.type = [id: int, name: string]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"java.lang.IllegalArgumentException: requirement failed: Vertex ID column 'id' missing from vertex DataFrame, which has columns: hero_id,hero_id","error":"<div class=\"ansiout\">\tat scala.Predef$.require(Predef.scala:233)\n\tat org.graphframes.GraphFrame$.apply(GraphFrame.scala:609)</div>","workflows":[],"startTime":1513048759166,"submitTime":1513048741865,"finishTime":1513048759342,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c7c07501-a86d-4bc2-a715-c5029ce788a1"},{"version":"CommandV1","origId":4000122366180249,"guid":"e5dcca30-245d-4666-84b2-667a6ffed847","subtype":"command","commandType":"auto","position":11.0,"command":"//Hero with most pick rate(pagerank)\nval ranks = heroGraph.pageRank.resetProbability(0.15).maxIter(10).run()\n\ndisplay(ranks.vertices.orderBy(desc(\"pagerank\")))","commandVersion":0,"state":"finished","results":{"type":"table","data":[[21,"Windranger",3.2962330869032477],[11,"Shadow Fiend",2.889254309994779],[74,"Invoker",1.9250894224272794],[7,"Earthshaker",1.9105464172309445],[28,"Slardar",1.7835670939085948],[39,"Queen of Pain",1.7255244081941463],[100,"Tusk",1.7154722721794133],[8,"Juggernaut",1.7094670809074417],[73,"Alchemist",1.6616936865],[14,"Pudge",1.6200733805603484],[1,"Anti-Mage",1.5550939344599009],[104,"Legion Commander",1.5028148375467996],[93,"Slark",1.415317805029367],[50,"Dazzle",1.3952756608193295],[86,"Rubick",1.383925744630407],[25,"Lina",1.3835251986622739],[5,"Crystal Maiden",1.351381816532916],[69,"Doom",1.3447442406609498],[42,"Wraith King",1.333682346046463],[112,"Winter Wyvern",1.3172204011257294],[106,"Ember Spirit",1.2833837830836308],[44,"Phantom Assassin",1.268197305292964],[26,"Lion",1.2659742788763746],[71,"Spirit Breaker",1.2607064405235378],[9,"Mirana",1.2551425323987955],[30,"Witch Doctor",1.2534884475244166],[75,"Silencer",1.2425679286554159],[67,"Spectre",1.1937399645797064],[72,"Gyrocopter",1.1757881985288898],[68,"Ancient Apparition",1.170130799041448],[62,"Bounty Hunter",1.1613995921320213],[46,"Templar Assassin",1.0657082273782508],[85,"Undying",1.05331175942584],[36,"Necrophos",1.045459515278525],[19,"Tiny",0.9498636232417934],[57,"Omniknight",0.9267943815832015],[87,"Disruptor",0.8768121336602507],[2,"Axe",0.8422548853831667],[31,"Lich",0.8372366025807156],[22,"Zeus",0.8353909723820732],[51,"Clockwerk",0.8116101034593178],[84,"Ogre Magi",0.8090307075326564],[20,"Vengeful Spirit",0.7948620644997803],[99,"Bristleback",0.7858334163975593],[70,"Ursa",0.7822337629631646],[55,"Dark Seer",0.7719691730883781],[32,"Riki",0.7660234319166515],[35,"Sniper",0.7420648094373072],[47,"Viper",0.7175481580929554],[59,"Huskar",0.7156512682879067],[12,"Phantom Lancer",0.7094050588287881],[27,"Shadow Shaman",0.692762976076109],[18,"Sven",0.6806988459058382],[97,"Magnus",0.669396243434452],[102,"Abaddon",0.6601023404454488],[53,"Nature's Prophet",0.6438081965391053],[41,"Faceless Void",0.6325383452660116],[16,"Sand King",0.6250773752657927],[60,"Night Stalker",0.6192131949185644],[110,"Phoenix",0.6113222245390065],[40,"Venomancer",0.609389397598284],[101,"Skywrath Mage",0.6074054248106832],[4,"Bloodseeker",0.6058795753009817],[98,"Timbersaw",0.5909599346590643],[107,"Earth Spirit",0.5696467349049594],[64,"Jakiro",0.5658340028442077],[88,"Nyx Assassin",0.5620616506840547],[6,"Drow Ranger",0.5536535133788206],[34,"Tinker",0.5529736111139125],[23,"Kunkka",0.5497686714090292],[56,"Clinkz",0.5413895353797314],[3,"Bane",0.5346401116267434],[63,"Weaver",0.5339726175189402],[54,"Lifestealer",0.5297605110636529],[33,"Enigma",0.5255918834607858],[17,"Storm Spirit",0.5136398580455328],[29,"Tidehunter",0.5119222367188598],[94,"Medusa",0.5089088563081687],[81,"Chaos Knight",0.5037626030656477],[48,"Luna",0.49616644222249984],[90,"Keeper of the Light",0.47927939301334954],[49,"Dragon Knight",0.44442331224919573],[15,"Razor",0.4418501748286281],[96,"Centaur Warrunner",0.4299382182999114],[37,"Warlock",0.42682036040878657],[83,"Treant Protector",0.4181301637001299],[43,"Death Prophet",0.41712686839105384],[95,"Troll Warlord",0.41395384960286974],[13,"Puck",0.413639929055425],[82,"Meepo",0.4111676786561206],[91,"Io",0.3983149772552395],[76,"Outworld Devourer",0.3869647421809713],[45,"Pugna",0.38119175214986933],[10,"Morphling",0.3765686631906147],[109,"Terrorblade",0.3753658019017506],[61,"Broodmother",0.3688706545222228],[79,"Shadow Demon",0.3645603764124182],[38,"Beastmaster",0.3477657392223321],[52,"Leshrac",0.3378422901311009],[105,"Techies",0.33002637718383443],[58,"Enchantress",0.313547961462338],[77,"Lycan",0.30526628743927064],[111,"Oracle",0.30346604829426005],[65,"Batrider",0.3021404977682428],[80,"Lone Druid",0.29989261354151353],[89,"Naga Siren",0.29885082949661934],[92,"Visage",0.2918252956451143],[78,"Brewmaster",0.2913323476149262],[103,"Elder Titan",0.2743237632101092],[66,"Chen",0.23226909089851927],[108,"Underlord",0.15],[113,"Arc Warden",0.15]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"integer\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"pagerank","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:64: error: not found: value stationGraph\n              val ranks = stationGraph.pageRank.resetProbability(0.15).maxIter(10).run()\n                          ^\n</div>","error":null,"workflows":[],"startTime":1513048759347,"submitTime":1513048741975,"finishTime":1513048769280,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5b2694a7-8640-47c8-b7f5-954e1f89d855"},{"version":"CommandV1","origId":4000122366180250,"guid":"f508eef0-150b-4432-bb81-3be90db5505c","subtype":"command","commandType":"auto","position":12.0,"command":"//Example - Top pick couple (tuples)\n//shown by ID\nval topHeros = heroGraph\n  .edges\n  .groupBy(\"src\", \"dst\")\n  .count()\n  .orderBy(desc(\"count\"))\n  .limit(20)\n\ndisplay(topHeros)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[7,21,1180],[21,7,1180],[11,7,1149],[7,11,1149],[11,28,1084],[28,11,1084],[11,21,1066],[21,11,1066],[21,28,1053],[28,21,1053],[21,8,970],[8,21,970],[100,11,963],[11,100,963],[100,21,955],[21,100,955],[8,11,923],[11,8,923],[14,21,880],[21,14,880]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"src","type":"\"integer\"","metadata":"{}"},{"name":"dst","type":"\"integer\"","metadata":"{}"},{"name":"count","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:82: error: value col is not a member of org.graphframes.GraphFrame\n                .join(heroVertices, heroGraph.col(&quot;src&quot;) === heroVertices.col(&quot;id&quot;))\n                                              ^\n</div>","error":null,"workflows":[],"startTime":1513048769285,"submitTime":1513048742093,"finishTime":1513048769659,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"barChart","width":"660","height":"auto","xColumns":["src"],"yColumns":["count"],"pivotColumns":["dst"],"pivotAggregation":"sum","customPlotOptions":{"barChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1737f038-1282-47b2-8277-63d7c296fa8a"},{"version":"CommandV1","origId":4000122366180251,"guid":"58993aa4-5de7-42c5-9fc5-d1d32e10e702","subtype":"command","commandType":"auto","position":13.0,"command":"//In Degree and Out Degree\nval inDeg = heroGraph.inDegrees\ndisplay(inDeg.orderBy(desc(\"inDegree\")).limit(10))","commandVersion":0,"state":"finished","results":{"type":"table","data":[[21,41296],[11,36032],[7,23352],[74,23296],[28,21780],[100,20828],[39,20760],[8,20548],[73,19852],[14,19260]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"integer\"","metadata":"{}"},{"name":"inDegree","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1513048769664,"submitTime":1513048742205,"finishTime":1513048770174,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"barChart","width":"660","height":"auto","xColumns":["id"],"yColumns":["inDegree"],"pivotColumns":[],"pivotAggregation":"sum","customPlotOptions":{"barChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"aa7aaa34-7c64-45b8-850f-26dc49dcb41d"},{"version":"CommandV1","origId":4000122366180252,"guid":"6100df84-1e79-4517-8bb0-f47856d0e357","subtype":"command","commandType":"auto","position":14.0,"command":"val outDeg = heroGraph.outDegrees\ndisplay(outDeg.orderBy(desc(\"outDegree\")).limit(5))","commandVersion":0,"state":"finished","results":{"type":"table","data":[[21,41296],[11,36032],[7,23352],[74,23296],[28,21780]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"integer\"","metadata":"{}"},{"name":"outDegree","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:76: error: not found: value stationGraph\n              val inDeg = stationGraph.inDegrees\n                          ^\n</div>","error":null,"workflows":[],"startTime":1513048770178,"submitTime":1513048742312,"finishTime":1513048770704,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c3048944-b630-491d-af82-8a1ae686a758"},{"version":"CommandV1","origId":4000122366180253,"guid":"6ad7960d-6b77-4f0f-8d65-bf0fb5d1f79e","subtype":"command","commandType":"auto","position":15.0,"command":"//I/O Degree alwasys 1, reason had shown above.\n//e.g. Chaos Knight is Ogre Magi's team mate, so that Ogre Magi is Chaos Knight's team mate.\n//So, all results are equal to 1 (i/o ratio)\nval degreeRatio = inDeg.join(outDeg, inDeg.col(\"id\") === outDeg.col(\"id\"))\n  .drop(outDeg.col(\"id\"))\n  .selectExpr(\"id\", \"double(inDegree)/double(outDegree) as degreeRatio\")\n\ndegreeRatio.cache()\n  \ndisplay(degreeRatio.orderBy(desc(\"degreeRatio\")).limit(10))\n//And \n//display(degreeRatio.orderBy(asc(\"degreeRatio\")).limit(10))","commandVersion":0,"state":"finished","results":{"type":"table","data":[[78,1.0],[85,1.0],[31,1.0],[65,1.0],[34,1.0],[101,1.0],[81,1.0],[28,1.0],[53,1.0],[76,1.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"integer\"","metadata":"{}"},{"name":"degreeRatio","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1513048770709,"submitTime":1513048742420,"finishTime":1513048771002,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"22e8cc02-6da2-49f3-85df-0a918be17be1"}],"dashboards":[],"guid":"60af8388-da90-4433-8ce9-1cf7cf4f6784","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/358a53f93460d41f62b95cfd5ce6436b528c2b229982b8159a580fbbb91ef1fb/js/metrics-graphics.js"
 onerror="window.mainJsLoadError = true;"></script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/358a53f93460d41f62b95cfd5ce6436b528c2b229982b8159a580fbbb91ef1fb/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/358a53f93460d41f62b95cfd5ce6436b528c2b229982b8159a580fbbb91ef1fb/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>
